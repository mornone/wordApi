<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word API æœåŠ¡ - æ¥å£æ–‡æ¡£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .section {
            background: white;
            padding: 30px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        h3 {
            color: #764ba2;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .endpoint {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .method {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9em;
        }
        .method.post {
            background: #28a745;
            color: white;
        }
        .method.get {
            background: #007bff;
            color: white;
        }
        .url {
            font-family: 'Courier New', monospace;
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            word-break: break-all;
        }
        .params {
            margin: 15px 0;
        }
        .param-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .param-name {
            font-weight: bold;
            color: #667eea;
        }
        .param-type {
            color: #6c757d;
            font-size: 0.9em;
            margin-left: 10px;
        }
        .required {
            color: #dc3545;
            font-size: 0.8em;
            margin-left: 5px;
        }
        .example {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .example pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .response {
            margin: 15px 0;
        }
        .status-code {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 3px;
            font-weight: bold;
            margin-right: 10px;
        }
        .status-200 {
            background: #d4edda;
            color: #155724;
        }
        .status-400 {
            background: #fff3cd;
            color: #856404;
        }
        .status-404 {
            background: #f8d7da;
            color: #721c24;
        }
        .status-500 {
            background: #f8d7da;
            color: #721c24;
        }
        footer {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            margin-top: 40px;
        }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .note strong {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“„ Word API æœåŠ¡</h1>
            <p>Word æ–‡æ¡£å¤„ç†ä¸è½¬æ¢ API æ¥å£æ–‡æ¡£</p>
        </header>

        <div class="section">
            <h2>ğŸ“– æ¦‚è¿°</h2>
            <p>Word API æœåŠ¡æä¾› Word æ–‡æ¡£çš„å¤„ç†å’Œè½¬æ¢åŠŸèƒ½ï¼Œæ”¯æŒï¼š</p>
            <ul style="margin: 15px 0 15px 30px;">
                <li>ä¸Šä¼  Word æ–‡æ¡£ï¼ˆ.docxï¼‰</li>
                <li>è‡ªåŠ¨æ›´æ–°æ–‡æ¡£ä¸­çš„åŸŸå’Œç›®å½•</li>
                <li>å¯¼å‡ºä¸º DOCX å’Œ PDF æ ¼å¼</li>
                <li>å¼‚æ­¥ä»»åŠ¡å¤„ç†</li>
                <li>æ–‡ä»¶ä¸‹è½½</li>
            </ul>
            
            <div class="note">
                <strong>æ³¨æ„ï¼š</strong> æ‰€æœ‰æ¥å£å‡æ”¯æŒå±€åŸŸç½‘è®¿é—®ï¼Œè¯·ä½¿ç”¨æœåŠ¡å™¨çš„å±€åŸŸç½‘ IP åœ°å€ã€‚
            </div>
        </div>

        <div class="section">
            <h2>ğŸ”Œ æ¥å£åˆ—è¡¨</h2>

            <!-- æ¥å£ 1: ä¸Šä¼ æ–‡æ¡£ -->
            <div class="endpoint">
                <h3>
                    <span class="method post">POST</span>
                    ä¸Šä¼ å¹¶å¤„ç† Word æ–‡æ¡£
                </h3>
                <div class="url">/wordapi</div>
                
                <h4>è¯·æ±‚å‚æ•°</h4>
                <div class="params">
                    <div class="param-item">
                        <span class="param-name">InputFile</span>
                        <span class="param-type">File</span>
                        <span class="required">å¿…å¡«</span>
                        <p style="margin-top: 5px; color: #6c757d;">è¦å¤„ç†çš„ Word æ–‡æ¡£æ–‡ä»¶ï¼ˆ.docx æ ¼å¼ï¼‰</p>
                    </div>
                </div>

                <h4>è¯·æ±‚ç¤ºä¾‹ï¼ˆä½¿ç”¨ multipart/form-dataï¼‰</h4>
                <div class="example">
                    <pre>POST http://192.168.1.100:5000/wordapi
Content-Type: multipart/form-data

InputFile: [é€‰æ‹©æ–‡ä»¶]</pre>
                </div>

                <h4>cURL ç¤ºä¾‹</h4>
                <div class="example">
                    <pre>curl -X POST http://192.168.1.100:5000/wordapi \
  -F "InputFile=@/path/to/document.docx"</pre>
                </div>

                <h4>å“åº”</h4>
                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡åˆ›å»ºæˆåŠŸ</p>
                    <div class="example">
                        <pre>{
  "status": "queued",
  "taskId": "38537043-0a96-4234-82b3-194b22312e35"
}</pre>
                    </div>
                </div>

                <div class="response">
                    <span class="status-code status-400">400 Bad Request</span>
                    <p style="margin: 10px 0;">è¯·æ±‚å‚æ•°é”™è¯¯</p>
                    <div class="example">
                        <pre>{
  "error": "InputFile is required."
}</pre>
                    </div>
                </div>
            </div>

            <!-- æ¥å£ 2: æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ -->
            <div class="endpoint">
                <h3>
                    <span class="method get">GET</span>
                    æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å’Œç»“æœ
                </h3>
                <div class="url">/wordapi?taskId={taskId}</div>
                
                <h4>è¯·æ±‚å‚æ•°</h4>
                <div class="params">
                    <div class="param-item">
                        <span class="param-name">taskId</span>
                        <span class="param-type">String</span>
                        <span class="required">å¿…å¡«</span>
                        <p style="margin-top: 5px; color: #6c757d;">ä¸Šä¼ æ–‡æ¡£æ—¶è¿”å›çš„ä»»åŠ¡ ID</p>
                    </div>
                </div>

                <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                <div class="example">
                    <pre>GET http://192.168.1.100:5000/wordapi?taskId=38537043-0a96-4234-82b3-194b22312e35</pre>
                </div>

                <h4>cURL ç¤ºä¾‹</h4>
                <div class="example">
                    <pre>curl -X GET "http://192.168.1.100:5000/wordapi?taskId=38537043-0a96-4234-82b3-194b22312e35"</pre>
                </div>

                <h4>å“åº”</h4>
                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡æ’é˜Ÿä¸­</p>
                    <div class="example">
                        <pre>{
  "taskId": "38537043-0a96-4234-82b3-194b22312e35",
  "status": "queued",
  "result": null
}</pre>
                    </div>
                </div>

                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡å¤„ç†ä¸­</p>
                    <div class="example">
                        <pre>{
  "taskId": "38537043-0a96-4234-82b3-194b22312e35",
  "status": "running",
  "result": null
}</pre>
                    </div>
                </div>

                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡å®Œæˆ</p>
                    <div class="example">
                        <pre>{
  "taskId": "38537043-0a96-4234-82b3-194b22312e35",
  "status": "completed",
  "result": {
    "docx": "/files/2026/0206/38537043-0a96-4234-82b3-194b22312e35.docx",
    "pdf": "/files/2026/0206/38537043-0a96-4234-82b3-194b22312e35.pdf"
  }
}</pre>
                    </div>
                </div>

                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡å¤±è´¥</p>
                    <div class="example">
                        <pre>{
  "taskId": "38537043-0a96-4234-82b3-194b22312e35",
  "status": "failed",
  "result": {
    "error": "é”™è¯¯ä¿¡æ¯"
  }
}</pre>
                    </div>
                </div>

                <div class="response">
                    <span class="status-code status-404">404 Not Found</span>
                    <p style="margin: 10px 0;">ä»»åŠ¡ä¸å­˜åœ¨</p>
                    <div class="example">
                        <pre>{
  "error": "taskId not found."
}</pre>
                    </div>
                </div>
            </div>

            <!-- æ¥å£ 3: ä¸‹è½½æ–‡ä»¶ -->
            <div class="endpoint">
                <h3>
                    <span class="method get">GET</span>
                    ä¸‹è½½å¤„ç†åçš„æ–‡ä»¶
                </h3>
                <div class="url">/files/{year}/{day}/{filename}</div>
                
                <h4>è¯·æ±‚å‚æ•°</h4>
                <div class="params">
                    <div class="param-item">
                        <span class="param-name">year</span>
                        <span class="param-type">String</span>
                        <span class="required">å¿…å¡«</span>
                        <p style="margin-top: 5px; color: #6c757d;">å¹´ä»½ï¼ˆ4ä½æ•°å­—ï¼Œå¦‚ 2026ï¼‰</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">day</span>
                        <span class="param-type">String</span>
                        <span class="required">å¿…å¡«</span>
                        <p style="margin-top: 5px; color: #6c757d;">æœˆæ—¥ï¼ˆ4ä½æ•°å­—ï¼Œå¦‚ 0206ï¼‰</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">filename</span>
                        <span class="param-type">String</span>
                        <span class="required">å¿…å¡«</span>
                        <p style="margin-top: 5px; color: #6c757d;">æ–‡ä»¶åï¼ˆåŒ…å«æ‰©å±•åï¼‰</p>
                    </div>
                </div>

                <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                <div class="example">
                    <pre>GET http://192.168.1.100:5000/files/2026/0206/38537043-0a96-4234-82b3-194b22312e35.docx</pre>
                </div>

                <h4>cURL ç¤ºä¾‹</h4>
                <div class="example">
                    <pre>curl -O http://192.168.1.100:5000/files/2026/0206/38537043-0a96-4234-82b3-194b22312e35.docx</pre>
                </div>

                <h4>å“åº”</h4>
                <div class="response">
                    <span class="status-code status-200">200 OK</span>
                    <p style="margin: 10px 0;">è¿”å›æ–‡ä»¶å†…å®¹ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰</p>
                    <p style="margin: 10px 0; color: #6c757d;">Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.documentï¼ˆDOCXï¼‰</p>
                    <p style="margin: 10px 0; color: #6c757d;">Content-Type: application/pdfï¼ˆPDFï¼‰</p>
                </div>

                <div class="response">
                    <span class="status-code status-404">404 Not Found</span>
                    <p style="margin: 10px 0;">æ–‡ä»¶ä¸å­˜åœ¨</p>
                    <div class="example">
                        <pre>{
  "error": "File not found."
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“ ä½¿ç”¨æµç¨‹</h2>
            <ol style="margin: 15px 0 15px 30px; line-height: 2;">
                <li><strong>ä¸Šä¼ æ–‡æ¡£ï¼š</strong>ä½¿ç”¨ POST /wordapi ä¸Šä¼  Word æ–‡æ¡£ï¼Œè·å¾— taskId</li>
                <li><strong>è½®è¯¢çŠ¶æ€ï¼š</strong>ä½¿ç”¨ GET /wordapi?taskId={taskId} æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€</li>
                <li><strong>ä¸‹è½½æ–‡ä»¶ï¼š</strong>å½“çŠ¶æ€ä¸º "completed" æ—¶ï¼Œä½¿ç”¨è¿”å›çš„ URL ä¸‹è½½å¤„ç†åçš„æ–‡ä»¶</li>
            </ol>

            <h3>å®Œæ•´ç¤ºä¾‹ï¼ˆJavaScriptï¼‰</h3>
            <div class="example">
                <pre>// 1. ä¸Šä¼ æ–‡æ¡£
const formData = new FormData();
formData.append('InputFile', fileInput.files[0]);

const uploadResponse = await fetch('http://192.168.1.100:5000/wordapi', {
  method: 'POST',
  body: formData
});
const { taskId } = await uploadResponse.json();

// 2. è½®è¯¢ä»»åŠ¡çŠ¶æ€
let status = 'queued';
while (status === 'queued' || status === 'running') {
  await new Promise(resolve => setTimeout(resolve, 2000)); // ç­‰å¾…2ç§’
  
  const statusResponse = await fetch(`http://192.168.1.100:5000/wordapi?taskId=${taskId}`);
  const data = await statusResponse.json();
  status = data.status;
  
  if (status === 'completed') {
    console.log('DOCX:', data.result.docx);
    console.log('PDF:', data.result.pdf);
    
    // 3. ä¸‹è½½æ–‡ä»¶
    window.open(`http://192.168.1.100:5000${data.result.docx}`);
    window.open(`http://192.168.1.100:5000${data.result.pdf}`);
  } else if (status === 'failed') {
    console.error('ä»»åŠ¡å¤±è´¥:', data.result.error);
  }
}</pre>
            </div>
        </div>

        <div class="section">
            <h2>âš™ï¸ ä»»åŠ¡çŠ¶æ€è¯´æ˜</h2>
            <div class="params">
                <div class="param-item">
                    <span class="param-name">queued</span>
                    <p style="margin-top: 5px; color: #6c757d;">ä»»åŠ¡å·²åˆ›å»ºï¼Œç­‰å¾…å¤„ç†</p>
                </div>
                <div class="param-item">
                    <span class="param-name">running</span>
                    <p style="margin-top: 5px; color: #6c757d;">ä»»åŠ¡æ­£åœ¨å¤„ç†ä¸­</p>
                </div>
                <div class="param-item">
                    <span class="param-name">completed</span>
                    <p style="margin-top: 5px; color: #6c757d;">ä»»åŠ¡å¤„ç†å®Œæˆï¼Œå¯ä»¥ä¸‹è½½æ–‡ä»¶</p>
                </div>
                <div class="param-item">
                    <span class="param-name">failed</span>
                    <p style="margin-top: 5px; color: #6c757d;">ä»»åŠ¡å¤„ç†å¤±è´¥ï¼ŒæŸ¥çœ‹ result.error è·å–é”™è¯¯ä¿¡æ¯</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>âš ï¸ æ³¨æ„äº‹é¡¹</h2>
            <ul style="margin: 15px 0 15px 30px; line-height: 2;">
                <li>ä»…æ”¯æŒ .docx æ ¼å¼çš„ Word æ–‡æ¡£</li>
                <li>æ–‡ä»¶ä¸Šä¼ ä½¿ç”¨ multipart/form-data æ ¼å¼</li>
                <li>ä»»åŠ¡å¤„ç†æ˜¯å¼‚æ­¥çš„ï¼Œéœ€è¦è½®è¯¢æŸ¥è¯¢çŠ¶æ€</li>
                <li>å»ºè®®è½®è¯¢é—´éš”ä¸º 2-5 ç§’</li>
                <li>æ–‡ä»¶ä¼šæŒ‰æ—¥æœŸè‡ªåŠ¨å½’æ¡£ï¼ˆå¹´/æœˆæ—¥ï¼‰</li>
                <li>æœåŠ¡å™¨å¯èƒ½é…ç½®äº†è‡ªåŠ¨æ¸…ç†ç­–ç•¥ï¼Œè¯·åŠæ—¶ä¸‹è½½æ–‡ä»¶</li>
                <li>æ‰€æœ‰æ¥å£æ”¯æŒè·¨åŸŸè®¿é—®ï¼ˆCORSï¼‰</li>
            </ul>
        </div>

        <footer>
            <p>Â© 2026 ä¿¡å®‰ä¸–çºª - Word API æœåŠ¡</p>
            <p style="margin-top: 10px;">
                <a href="https://www.secdriver.com" style="color: #667eea; text-decoration: none;">www.secdriver.com</a>
            </p>
        </footer>
    </div>
</body>
</html>
